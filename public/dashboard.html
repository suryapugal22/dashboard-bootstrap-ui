<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>

    <link rel="stylesheet" href="/node_modules/bootstrap/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.22/css/dataTables.bootstrap4.min.css">

</head>

<body>
    <div class="wrapper">

        <nav class="navbar navbar-expand-md sticky-top flex-md-nowrap navbar-dark bg-dark text-light"
            style="z-index: 1020;">
            <a class="navbar-brand" href="#">Brand</a>

            <form class="form-inline ml-auto mr-2  ">
                <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
                <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
            </form>
            <ul class="navbar-nav mx-3">
                <!-- <li class="nav-item"> -->

                <!-- </li> -->
                <li class="nav-item"><a href="#" class="nav-link">Sign Out</a></li>
            </ul>

            <button class="navbar-toggler mr-0" type="button" data-toggle="collapse" data-target="#sidebarMenu"
                aria-controls="sidebarMenu" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
        </nav>


        <div class="container-fluid">

            <div class="row position-relative">

                <nav class="sidebar collapse navbar-collapse col-md-3 col-lg-2 d-md-block bg-light" id="sidebarMenu"
                    style="position: fixed; top: 0; bottom: 0;left: 0;right: 0; padding-top: 56px; z-index: 100;">
                    <div class="position-sticky pt-3">
                        <ul class="navbar-nav">
                            <li class="nav-item active">
                                <a class="nav-link" href="#">Dashboard <span class="sr-only">(current)</span></a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#">Ethics Committee</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#">Sponsors</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#">CRO</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#">Sites</a>
                            </li>
                        </ul>
                    </div>
                </nav>

                <main class="col-12 col-md-9 col-lg-10 ml-auto">

                    <div class="container-fluid pt-3">

                        <div class="row m-0 justify-content-between align-items-center">
                            <h1>Dashboard</h1>

                            <div class="form-group m-0">
                                <select class="form-control" name="accessRole" id="accessRole">
                                    <option selected>Super Admin</option>
                                    <option> Principal Investigator </option>
                                </select>
                            </div>

                            <div class="modal fade" id="modelId" tabindex="-1" role="dialog"
                                aria-labelledby="modelTitleId" aria-hidden="true">
                                <div class="modal-dialog modal-lg" role="document">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title">Fill In Details</h5>
                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                <span aria-hidden="true">&times;</span>
                                            </button>
                                        </div>
                                        <div class="modal-body">

                                            <form>

                                                <div class="row flex-wrap">

                                                    <div class="form-group col-6">
                                                        <label for="newFirstName">First Name</label>
                                                        <input type="text" name="newFirstName" id="newFirstName"
                                                            class="form-control" placeholder="First Name"
                                                            aria-describedby="helpId">
                                                        <small id="helpId" class="text-muted"></small>
                                                    </div>

                                                    <div class="form-group col-6">
                                                        <label for="newLastName">Last Name</label>
                                                        <input type="text" name="newLastName" id="newLastName"
                                                            class="form-control" placeholder="Last Name"
                                                            aria-describedby="helpId">
                                                        <small id="helpId" class="text-muted"></small>
                                                    </div>

                                                    <div class="form-group col-6">
                                                        <label for="newEmail">Email</label>
                                                        <input type="email" name="newEmail" id="newEmail"
                                                            class="form-control" placeholder="Example@email.com"
                                                            aria-describedby="helpId">
                                                        <small id="helpId" class="text-muted"></small>
                                                    </div>

                                                    <div class="form-group col-6">
                                                        <label for="newPhoneNo">Phone Number</label>
                                                        <input type="tel" name="newPhoneNo" id="newPhoneNo"
                                                            class="form-control" placeholder="Phone Number"
                                                            aria-describedby="helpId">
                                                        <small id="helpId" class="text-muted"></small>
                                                    </div>

                                                    <div class="form-group col-6">
                                                        <label for="newPassword">Password</label>
                                                        <input type="password" name="newPassword" id="newPassword"
                                                            class="form-control" placeholder="Password"
                                                            aria-describedby="helpId">
                                                        <small id="helpId" class="text-muted"></small>
                                                    </div>

                                                    <div class="form-group col-6">
                                                        <label for="confirmPassword">Confirm Password</label>
                                                        <input type="password" name="confirmPassword"
                                                            id="confirmPassword" class="form-control"
                                                            placeholder="Confirm Password" aria-describedby="helpId">
                                                        <small id="helpId" class="text-muted"></small>
                                                    </div>

                                                    <div class="form-group col-6">
                                                        <label for="newOrganizationName">Name of the
                                                            Organization</label>
                                                        <input type="text" name="newOrganizationName"
                                                            id="newOrganizationName" class="form-control"
                                                            placeholder="Organization Name" aria-describedby="helpId">
                                                        <small id="helpId" class="text-muted"></small>
                                                    </div>

                                                    <div class="form-group col-6">
                                                        <label for="newOrganizationType">Organization Type</label>
                                                        <select class="form-control" name="newOrganizationType"
                                                            id="newOrganizationType">
                                                            <option disabled selected>Select Type</option>
                                                            <option>Ethics Committee</option>
                                                            <option>Sponsor</option>
                                                            <option>CRO/Vendor</option>
                                                            <option>Hospital Site</option>
                                                        </select>
                                                    </div>

                                                    <div class="form-group col-12">
                                                        <label for="newOrganizationAddress">Organization Address</label>
                                                        <input type="text" name="newOrganizationAddress"
                                                            id="newOrganizationAddress" class="form-control"
                                                            placeholder="Address" aria-describedby="helpId">
                                                        <small id="helpId" class="text-muted"></small>
                                                    </div>

                                                    <div class="form-group col-6">
                                                        <label for="newCity">City</label>
                                                        <select class="form-control" name="newCity" id="newCity">
                                                            <option disabled selected> Select City </option>
                                                            <option>Chennai</option>
                                                            <option>Bangalore</option>
                                                            <option>Mumbai</option>
                                                        </select>
                                                    </div>

                                                    <div class="form-group col-6">
                                                        <label for="newState">State</label>
                                                        <select class="form-control" name="newState" id="newState">
                                                            <option disabled selected>Select State</option>
                                                            <option>Tamil Nadu</option>
                                                            <option>Karnataka</option>
                                                            <option>Rajasthan</option>
                                                        </select>
                                                    </div>

                                                    <div class="form-group col-6">
                                                        <label for="newCountry">Country</label>
                                                        <select class="form-control" name="newCountry" id="newCountry">
                                                            <option disabled selected>Select Country</option>
                                                            <option>India</option>
                                                            <option>Afghanistan</option>
                                                            <option>Albania</option>
                                                        </select>
                                                    </div>

                                                    <div class="form-group col-6">
                                                        <label for="newZipcode">Zip Code</label>
                                                        <input type="text" name="newZipcode" id="newZipcode"
                                                            class="form-control" placeholder="Zip Code"
                                                            aria-describedby="helpId">
                                                        <small id="helpId" class="text-muted"></small>
                                                    </div>

                                                </div>

                                            </form>

                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-secondary"
                                                data-dismiss="modal">Close</button>
                                            <button type="button" class="btn btn-primary">Save</button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>

                        <button type="button" class="btn btn-primary d-block ml-auto " data-toggle="modal"
                            data-target="#modelId">
                            + Add New Group
                        </button>


                        <div class="row row-cols-1 row-cols-sm-2 row-cols-md-4 mt-4">

                            <div class="col mb-4">
                                <div class="card h-100">
                                    <div class="card-body">
                                        <div class="h-100 d-flex flex-column mx-0 justify-content-between">
                                            <a href="#" class="card-link card-title h5 text-dark">New Ethics
                                                Committee</a>
                                            <div class="ml-1 mr-0 display-3">23</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col mb-4">
                                <div class="card h-100">
                                    <div class="card-body">
                                        <div class="h-100 d-flex flex-column mx-0 justify-content-between">
                                            <a href="#" class="card-link card-title h5 text-dark">Verified Ethics
                                                Committee</a>
                                            <div class="ml-1 mr-0 display-3">01</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col mb-4">
                                <div class="card h-100">
                                    <div class="card-body">
                                        <div class="h-100 d-flex flex-column  mx-0 justify-content-between">
                                            <a href="#" class="card-link card-title h5 text-dark">Pending Ethics
                                                Committee</a>
                                            <div class="ml-1 mr-0 display-3">02</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col mb-4">
                                <div class="card h-100">
                                    <div class="card-body">
                                        <div class="h-100 d-flex flex-column mx-0 justify-content-between">
                                            <a href="#" class="card-link card-title h5 text-dark">Total Ethics
                                                Committee</a>
                                            <div class="display-3">20</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>

                        <table class="table table-striped mt-4" id="table">
                            <thead>
                                <tr>
                                    <th scope="col">EC ID</th>
                                    <th scope="col">EC Name</th>
                                    <th scope="col">Created On</th>
                                    <th scope="col">Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr data-id="14">
                                    <th scope="row">#14</th>
                                    <td>Mark</td>
                                    <td>8 days Ago</td>
                                    <td>Approval</td>
                                </tr>
                                <tr data-id="21">
                                    <th scope="row">#21</th>
                                    <td>Jacob</td>
                                    <td>2 days ago</td>
                                    <td>Created</td>
                                </tr>
                                <tr data-id="22">
                                    <th scope="row">#22</th>
                                    <td>Jacob</td>
                                    <td>2 days ago</td>
                                    <td>Verification</td>
                                </tr>
                                <tr>
                                    <th scope="row">#23</th>
                                    <td>Larry</td>
                                    <td>Yesterday</td>
                                    <td>Awaiting</td>
                                </tr>
                                <tr>
                                    <th scope="row">#14</th>
                                    <td>Mark</td>
                                    <td>8 days Ago</td>
                                    <td>Approval</td>
                                </tr>
                                <tr>
                                    <th scope="row">#21</th>
                                    <td>Jacob</td>
                                    <td>2 days ago</td>
                                    <td>Created</td>
                                </tr>
                                <tr>
                                    <th scope="row">#22</th>
                                    <td>Jacob</td>
                                    <td>2 days ago</td>
                                    <td>Verification</td>
                                </tr>
                                <tr>
                                    <th scope="row">#23</th>
                                    <td>Larry</td>
                                    <td>Yesterday</td>
                                    <td>Awaiting</td>
                                </tr>
                            </tbody>
                        </table>

                    </div>

                </main>

            </div>

        </div>


    </div>

    <script src="/node_modules/axios/dist/axios.min.js"></script>
    <script src="/node_modules/jquery/dist/jquery.min.js"></script>
    <script src="/node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="/node_modules/datatables.net/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.22/js/dataTables.bootstrap4.min.js"></script>
    <script src="https://cdn.tiny.cloud/1/no-api-key/tinymce/5/tinymce.min.js" referrerpolicy="origin"></script>

    <script>
        $(document).ready(function () {
            $('#table').DataTable();
        });

        document.querySelector("#accessRole").addEventListener("change", () => {
            console.log(document.querySelector("#accessRole").value);
        })

        let main = $("main .container-fluid").clone();
        function ecDetail(id) {
            $("main").load("ecDetail.html");
        }

        document.querySelectorAll("tr[data-id]").forEach(tr => {
            tr.addEventListener("click", () => {
                event.preventDefault();
                console.log(tr.dataset.id);
                ecDetail(tr.dataset.id);
            })
        });

        function back() {
            console.log(main);
            $('main').html(main);
        }

    </script>

    <script>

        let userProfile;
        let params;

        axios.post(`https://api-sage.assaycr.in:8443/security/v2/roles`,
            {
                "username": localStorage.getItem("user"),
                "token": localStorage.getItem("token")
            }, {
            headers: {
                Authorization: 'Bearer ' + localStorage.getItem("token")
            }
        }).then(res => {
            console.log(res);
            userProfile = res.data;
            console.log(userProfile);

            params = {
                "username": localStorage.getItem("user"),
                "profileId": userProfile[0].profileId
            }

            getDashboardData();
        })

        function getDashboardData() {
            let url1 = `https://api-sage.assaycr.in:8443/dashboard/v3/dashboardpage?username=${params.username}&profileId=${userProfile[0].profileId}`

            axios.post(url1, null, {
                headers: {
                    Authorization: 'Bearer ' + localStorage.getItem("token")
                }
            }).then(res => {
                console.log(res);
            })
        }


    </script>

</body>

</html>